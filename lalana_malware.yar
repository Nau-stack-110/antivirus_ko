rule MalwareDetection
{
    meta:
        description = "Detecte des comportements suspectes dans des executables"
        author = "Utilisateur"
        threat_level = "high"
        target_type = "PE file"
        date = "2025-01-27"
        references = "https://exemple.com/indicateurs"
    strings: 
        $malicious_code = { E8 ?? ?? ?? ?? 85 C0 74 0C}
        $malicious_url = "bad-malware-site.com"
        $supcious_behaviour = "CreateRemoteThread"
    condition:
        $malicious_code or $malicious_url or $supcious_behaviour
}

rule DetectTextFiles 
{
    meta:
        description = "Detecte des comportements suspectes dans des fichiers textes executables"
        author = "Utilisateur"
        date = "2025-01-26"
    strings:
        $keyword1 = "password"
        $keyword2 = "confidential"
        $keyword3 = "private"
    condition:
        any of ($keyword1, $keyword2, $keyword3)
}

rule DetectPythonFiles 
{
    meta:
        description = "Detecte des comportements suspectes dans des fichiers Python executables"
        author = "Utilisateur"
        date = "2025-01-26"
    strings:
        $import_os = "import os"
        $import_sys = "import sys"
        $eval_exec = "exec("
        $eval_eval = "eval("
    condition:
        any of ($import_os, $import_sys, $eval_eval, $eval_exec)
}

rule DetectBashFiles
{
    meta:
        description = "Detecte des comportements suspectes dans des executables"
        author = "Utilisateur"
        threat_level = "high"
        target_type = "PE file"
        date = "2025-01-27"
    strings: 
        $shebang = "#!/bin/bash"
        $rm_command = "rm -rf /"
        $wget_command = "wget"
        $curl_commangd = "curl"
        $reverse_shell = /bash -i >& \/dev\/ tcp\/.* 0>&1/
    condition:
        any of ($shebang, $rm_command, $wget_command, $curl_commangd, $reverse_shell)
}
